<view class="container">
  
  <view class="filter-bar">
    <view class="student-switch">
      <text class="label">当前学生：</text>
      <text class="value">{{studentList[currentStudentIndex].name}}</text>
    </view>
    
    <picker mode="selector" range="{{scoreList}}" range-key="exam_name" bindchange="onPickerChange">
      <view class="exam-picker">
        <text>{{currentExam ? currentExam.exam_name : '暂无考试记录'}}</text>
        <text class="arrow">▼</text>
      </view>
    </picker>
  </view>

  <view class="score-card" wx:if="{{currentExam}}">
    <view class="card-content">
      <view class="total-section">
        <view class="total-label">总分</view>
        <view class="total-num">
          {{currentExam.total_score}}<text class="unit">分</text>
        </view>
      </view>
      
      <view class="v-line"></view>

      <view class="rank-section">
        <view class="rank-row">
          <text class="rank-label">班级排名</text>
          <text class="rank-val">{{currentExam.class_rank || '--'}}</text>
        </view>
        <view class="rank-row mt-10">
          <text class="rank-label">年级排名</text>
          <text class="rank-val">{{currentExam.grade_rank || '--'}}</text>
        </view>
      </view>
    </view>
  </view>

  <view class="subject-list" wx:if="{{currentExam}}">
    <block wx:for="{{currentExam.subjects}}" wx:key="name">
      <view class="subject-item">
        <view class="sub-name">{{item.name}}</view>
        <view class="progress-box">
          <view class="progress-bar {{item.scoreClass}}" style="{{item.widthStyle}}"></view>
        </view>
        <view class="sub-score">{{item.score}}</view>
      </view>
    </block>
  </view>

  <view class="empty-box" wx:if="{{!loading && !currentExam}}">
    <text>暂无成绩记录</text>
  </view>
</view>